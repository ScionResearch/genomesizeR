<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>About the input and the output • genomesizeR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="About the input and the output">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">genomesizeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.0002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/genomesizeR.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/methods.html">Method description</a></li>
    <li><a class="dropdown-item" href="../articles/compare_methods.html">Comparing estimation methods</a></li>
    <li><a class="dropdown-item" href="../articles/input_output.html">About the input and the output</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ScionResearch/genomesizeR/issues">Report an issue</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ScionResearch/genomesizeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>About the input and the output</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ScionResearch/genomesizeR/blob/HEAD/vignettes/input_output.Rmd" class="external-link"><code>vignettes/input_output.Rmd</code></a></small>
      <div class="d-none name"><code>input_output.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="input">Input<a class="anchor" aria-label="anchor" href="#input"></a>
</h3>
<p>The <code><a href="../reference/estimate_genome_size.html">estimate_genome_size()</a></code> function of
<code>genomesizeR</code> accepts those input formats:</p>
<p><strong>- Any csv-like file with a column containing either NCBI
taxids or taxon names (<code>format='csv'</code> option, and specify
<code>sep</code>, <code>match_column</code> and <code>match_sep</code>
if needed), e.g.:</strong></p>
<p><code>input.csv</code>:</p>
<pre><code>Id,Taxid,Taxon_name
1,562,Escherichia coli
2,9606,Homo sapiens</code></pre>
<pre><code><span><span class="va">output</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_genome_size.html">estimate_genome_size</a></span><span class="op">(</span><span class="st">'input.csv'</span>, <span class="st">'genomesizeRdata.tar.gz'</span>, </span>
<span>                              format<span class="op">=</span><span class="st">'csv'</span>, sep<span class="op">=</span><span class="st">','</span>, match_column<span class="op">=</span><span class="st">'Taxid'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">OR</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_genome_size.html">estimate_genome_size</a></span><span class="op">(</span><span class="st">'input.csv'</span>, <span class="st">'genomesizeRdata.tar.gz'</span>, </span>
<span>                              format<span class="op">=</span><span class="st">'csv'</span>, sep<span class="op">=</span><span class="st">','</span>, match_column<span class="op">=</span><span class="st">'Taxon_name'</span><span class="op">)</span></span></code></pre>
<p><strong>- The common ‘taxonomy table’ format used by popular packages
such as <a href="https://joey711.github.io/phyloseq/import-data.html" class="external-link">phyloseq</a>
(<code>format='tax_table'</code> option) e.g.:</strong></p>
<p><code>input.csv</code>:</p>
<pre><code>TaxonID,Kingdom,Phylum,Class,Order,Family,Genus,Species
taxon1,Bacteria,Proteobacteria,Gammaproteobacteria,Enterobacterales,Enterobacteriaceae,Escherichia,Escherichia coli
taxon2,Eukaryota,Chordata,Mammalia,Primates,Hominidae,Homo,Homo sapiens</code></pre>
<pre><code><span><span class="va">output</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_genome_size.html">estimate_genome_size</a></span><span class="op">(</span><span class="st">'input.csv'</span>, <span class="st">'genomesizeRdata.tar.gz'</span>, </span>
<span>                              format<span class="op">=</span><span class="st">'tax_table'</span>, sep<span class="op">=</span><span class="st">','</span><span class="op">)</span></span></code></pre>
<p><strong>A tax_table object can also be directly used as input,
e.g.:</strong></p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217" class="external-link">phyloseq</a></span><span class="op">)</span></span>
<span><span class="va">taxmat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"input.csv"</span>, row.names <span class="op">=</span> <span class="fl">1</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">taxmat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">taxmat</span><span class="op">)</span></span>
<span><span class="va">tax_tab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html" class="external-link">tax_table</a></span><span class="op">(</span><span class="va">taxmat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_genome_size.html">estimate_genome_size</a></span><span class="op">(</span><span class="va">tax_tab</span>, <span class="st">'genomesizeRdata.tar.gz'</span>, </span>
<span>                              format<span class="op">=</span><span class="st">'tax_table'</span><span class="op">)</span></span></code></pre>
<p><strong>- A file in <a href="http://biom-format.org/" class="external-link">BIOM format</a>
(<code>format='biom'</code> option) e.g.:</strong></p>
<p><code>input.biom</code>:</p>
<pre><code>{
  "id": null,
  "format": "Biological Observation Matrix 1.0.0",
  "format_url": "http://biom-format.org",
  "type": "OTU table",
  "generated_by": "example",
  "date": "2025-10-02T00:00:00",
  "matrix_type": "dense",
  "matrix_element_type": "int",
  "shape": [2, 1],
  "rows": [
    {
      "id": "taxon1",
      "metadata": {
        "taxonomy": [
          "k__Bacteria",
          "p__Proteobacteria",
          "c__Gammaproteobacteria",
          "o__Enterobacterales",
          "f__Enterobacteriaceae",
          "g__Escherichia",
          "s__Escherichia coli"
        ]
      }
    },
    {
      "id": "taxon2",
      "metadata": {
        "taxonomy": [
          "k__Eukaryota",
          "p__Chordata",
          "c__Mammalia",
          "o__Primates",
          "f__Hominidae",
          "g__Homo",
          "s__Homo sapiens"
        ]
      }
    }
  ],
  "columns": [
    { "id": "sample1", "metadata": null }
  ],
  "data": [1, 1]
}</code></pre>
<pre><code><span><span class="va">output</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_genome_size.html">estimate_genome_size</a></span><span class="op">(</span><span class="st">'input.biom'</span>, <span class="st">'genomesizeRdata.tar.gz'</span>, </span>
<span>                              format<span class="op">=</span><span class="st">'biom'</span><span class="op">)</span></span></code></pre>
<p><strong>- Any table-like object (data.frame, matrix…) with a column
containing either NCBI taxids or taxon names
(<code>format='dataframe'</code> option) e.g.:</strong></p>
<pre><code><span><span class="va">input_table</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>                Taxid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">562</span>, <span class="fl">9606</span><span class="op">)</span>,</span>
<span>                Taxon_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Escherichia coli"</span>, <span class="st">"Homo sapiens"</span><span class="op">)</span>,</span>
<span>                stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>              <span class="op">)</span></span>
<span></span>
<span><span class="co"># input_table:</span></span>
<span><span class="co">#   Taxid       Taxon_name</span></span>
<span><span class="co"># 1   562 Escherichia coli</span></span>
<span><span class="co"># 2  9606     Homo sapiens</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_genome_size.html">estimate_genome_size</a></span><span class="op">(</span><span class="va">input_table</span>, <span class="st">'genomesizeRdata.tar.gz'</span>, </span>
<span>                              format<span class="op">=</span><span class="st">'dataframe'</span>, match_column<span class="op">=</span><span class="st">'Taxid'</span><span class="op">)</span></span></code></pre>
<p><strong>- A vector containing either NCBI taxids or taxon names
(<code>format='vector'</code> option) e.g.:</strong></p>
<pre><code><span><span class="va">input_vector</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Escherichia coli"</span>, <span class="st">"Homo sapiens"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_genome_size.html">estimate_genome_size</a></span><span class="op">(</span><span class="va">input_vector</span>, <span class="st">'genomesizeRdata.tar.gz'</span>, </span>
<span>                              format<span class="op">=</span><span class="st">'vector'</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="reference-database">Reference database<a class="anchor" aria-label="anchor" href="#reference-database"></a>
</h3>
<p>The genome size reference database used is built by querying all
genome metadata information from the curated NCBI RefSeq database.
Filters are applied to only keep full genomes, and discard data that the
NCBI has tagged as anomalous, or abnormally large or small.</p>
<p>This raw database is then prepared to include more pre-computed
information to be used by the package. Genome sizes are aggregated to
the species level by iteratively averaging all entries below, hence the
package can only provide estimates at the level of species and
above.</p>
</div>
<div class="section level3">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p>The output format is a data frame with the same columns as the input
if the input was a standard data frame, with some added columns
providing information about the estimation and the quality of the
estimation. An option also allows an output format containing only the
estimation information (<code>TAXID</code>,
<code>estimated_genome_size</code>,
<code>confidence_interval_lower</code>,
<code>confidence_interval_upper</code>,
<code>genome_size_estimation_status</code>,
<code>model_used</code>).</p>
<p>Columns added:</p>
<ul>
<li>
<code>estimated_genome_size</code>: Estimated genome size</li>
<li>
<code>confidence_interval_lower</code>: Lower limit of the
confidence interval</li>
<li>
<code>confidence_interval_upper</code>: Upper limit of the
confidence interval</li>
<li>
<code>genome_size_estimation_status</code>: Whether the estimation
succeeded (‘OK’) or if failed, the reason for failure:
<ul>
<li>‘Query is NA’: The query’s taxon could not be read from the
input</li>
<li>‘NCBI taxid not found’: The query’s taxon was not found in the
database</li>
<li>‘Parent taxids not found’: The taxa at ranks above the query’s taxon
could not be computed</li>
<li>‘Parent taxid ranks not found’: The ranks of the taxa above the
query’s taxon could not be computed</li>
<li>‘Not enough genome size references for close taxa’: With the
weighted mean method, there were no references found close enough in the
taxonomic tree to the query to estimate a genome size</li>
<li>‘Confidence interval to estimated size ratio &gt; ci_threshold’: The
ratio of the confidence interval to the estimated size is greater than
the chosen threshold</li>
<li>‘Could not compute confidence interval’: The genome size was
successfully estimated, but the confidence interval could not be
estimated</li>
<li>‘No reference and query too high in taxonomic tree to fit in model’:
The lmm model is not able to estimate a genome size for the query</li>
<li>‘Bayesian model not found’: There was an issue loading bayesian
models</li>
</ul>
</li>
<li>
<code>model_used</code>: The model used for the estimation</li>
<li>
<code>LCA</code>: If queries are made of a list of taxa, taxid of
their Last Common Ancestor. Otherwise, <code>LCA</code> is equal to
<code>TAXID</code>.</li>
<li>NCBI taxids of all taxonomic ranks, with one column per rank</li>
<li>
<code>genome_size_estimation_rank</code>: Rank of the parent taxon
used for the estimation (weighted mean method only)</li>
<li>
<code>genome_size_estimation_distance</code>: Distance in tree nodes
(ranks) between the query and the parent taxon used for the estimation
(weighted mean method only)</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Celine Mercier, Joane Ellouet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
